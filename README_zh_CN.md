# Codeforces Tool

[![Github release](https://img.shields.io/github/release/xalanq/cf-tool.svg)](https://github.com/xalanq/cf-tool/releases)
[![platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-blue.svg)](https://github.com/xalanq/cf-tool/releases)
[![Build Status](https://travis-ci.org/xalanq/cf-tool.svg?branch=master)](https://travis-ci.org/xalanq/cf-tool)
[![Go Report Card](https://goreportcard.com/badge/github.com/xalanq/cf-tool)](https://goreportcard.com/report/github.com/xalanq/cf-tool)
[![Go Version](https://img.shields.io/badge/go-%3E%3D1.12-green.svg)](https://github.com/golang)
[![license](https://img.shields.io/badge/license-MIT-%23373737.svg)](https://raw.githubusercontent.com/xalanq/cf-tool/master/LICENSE)

一款快速、小巧、跨平台且强大的 [Codeforces](https://codeforces.com) 命令行工具。

[安装](#安装) | [使用方法](#使用方法) | [常见问题](#常见问题) | [English](./README.md)

## 特点

- **比赛支持** - Contests、Gym、Groups 和 acmsguru
- **全语言支持** - Codeforces 上的所有编程语言
- **完整工作流** - 提交代码、查看状态、获取样例、本地编译测试
- **代码管理** - 克隆提交记录、模板生成代码、拉取 AC 代码
- **浏览器集成** - 在浏览器中打开题目、榜单和提交页面
- **网络功能** - 支持代理和镜像站
- **彩色终端** - 美观的终端输出

欢迎提交 Pull Requests！

![](./assets/readme_1.gif)

## 安装

从 [Releases](https://github.com/xalanq/cf-tool/releases) 下载预编译的可执行文件。

或从源码编译 **(go >= 1.12)**：

```bash
git clone https://github.com/xalanq/cf-tool
cd cf-tool
go build -ldflags "-s -w" -o cf .
```

## 登录

运行 `cf config` 并选择选项 `0`（登录）。

### 方式一：Chrome 扩展（推荐）

安装 **[CF-Tool Login Helper](https://chromewebstore.google.com/detail/cf-tool-login-helper/lphndghbifbjefmhoejdpconiehgnkfp)** - 安装后登录将自动完成！

### 方式二：手动登录

1. 在浏览器中登录 Codeforces
2. 打开开发者工具控制台（Mac: `Cmd+Option+J`，Windows/Linux: `F12`）
3. 粘贴代码片段（已自动复制到剪贴板）并按回车

> 您的凭据不会离开您的计算机 - cookies 仅发送到 localhost。

## 使用方法

### 快速开始：参加比赛

```bash
cf race 1136                    # 开始比赛 1136
cd ./cf/contest/1136/a          # 进入 A 题目录
cf gen                          # 从模板生成代码
vim a.cpp                       # 编写解题代码
cf test                         # 编译并测试样例
cf submit                       # 提交代码
cf list                         # 查看题目信息
cf stand                        # 在浏览器中打开榜单
```

### 命令列表

| 命令 | 说明 |
|------|------|
| `cf config` | 配置用户名、密码和模板 |
| `cf submit [-f <file>] [<specifier>...]` | 提交代码 |
| `cf list [<specifier>...]` | 查看题目信息 |
| `cf parse [<specifier>...]` | 获取题目样例 |
| `cf gen [<alias>]` | 从模板生成代码 |
| `cf test [<file>]` | 本地编译测试 |
| `cf watch [all] [<specifier>...]` | 查看提交状态 |
| `cf open [<specifier>...]` | 在浏览器中打开题目 |
| `cf stand [<specifier>...]` | 在浏览器中打开榜单 |
| `cf sid [<specifier>...]` | 打开提交页面 |
| `cf race [<specifier>...]` | 开始比赛 |
| `cf pull [ac] [<specifier>...]` | 拉取提交的代码 |
| `cf clone [ac] [<handle>]` | 克隆某人的提交记录 |
| `cf upgrade` | 升级 cf-tool |

### 说明符

说明符用于灵活指定比赛/题目：
- URL：`https://codeforces.com/contest/100`、`https://codeforces.com/contest/180/problem/A`
- ID：`1111A`、`1111`、`a`
- 小组：`https://codeforces.com/group/Cw4JRyRGXR/contest/269760`、`Cw4JRyRGXR`

### 示例

```bash
# 提交代码
cf submit                              # 自动检测文件
cf submit -f a.cpp 100 a               # 指定文件和题目
cf submit gym 100001 a                 # Gym 提交

# 获取样例
cf parse 100                           # 获取比赛 100 的所有样例
cf parse gym 100001a                   # 获取指定 Gym 题目样例

# 拉取代码
cf pull ac 100 a                       # 拉取 AC 代码
cf clone xalanq                        # 克隆 xalanq 的所有代码
```

## 模板

### 模板占位符

在模板代码中使用以下占位符 - 运行 `cf gen` 时会自动替换：

| 占位符 | 值 |
|--------|-----|
| `$%U%$` | 用户名（如 xalanq）|
| `$%Y%$` | 年（如 2019）|
| `$%M%$` | 月（如 04）|
| `$%D%$` | 日（如 09）|
| `$%h%$` | 时（如 08）|
| `$%m%$` | 分（如 05）|
| `$%s%$` | 秒（如 00）|

### 模板示例

```cpp
/* Generated by Codeforces Tool
 * https://github.com/xalanq/cf-tool
 * Author: $%U%$
 * Time: $%Y%$-$%M%$-$%D%$ $%h%$:$%m%$:$%s%$
 */

#include <bits/stdc++.h>
using namespace std;

typedef long long ll;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    
    return 0;
}
```

### 脚本占位符

在模板脚本（before_script、script、after_script）中可使用以下占位符：

| 占位符 | 值 |
|--------|-----|
| `$%path%$` | 源文件路径（如 `/home/xalanq/`）|
| `$%full%$` | 完整文件名（如 `a.cpp`）|
| `$%file%$` | 不含扩展名的文件名（如 `a`）|
| `$%rand%$` | 8 位随机字符串（a-z, 0-9）|

## 数据文件

cf-tool 将数据存储在用户主目录下：

| 文件 | 内容 |
|------|------|
| `~/.cf/config` | 配置信息（模板等）|
| `~/.cf/session` | 会话数据（cookies、凭据等）|

## 常见问题

### 双击程序没有反应

cf-tool 是命令行工具，请在终端中运行。

### 无法使用 `cf` 命令

将 `cf` 程序放到 PATH 环境变量包含的目录中（如 Linux 的 `/usr/bin/`），或将其所在目录添加到 PATH 环境变量。

### 如何添加新的测试数据

创建 `inK.txt` 和 `ansK.txt` 文件，其中 K 是任意数字字符串（0-9）。

### 启用 Tab 自动补全

使用 [Infinidat/infi.docopt_completion](https://github.com/Infinidat/infi.docopt_completion)。每次更新添加新命令后，请重新运行 `docopt-completion cf`。
